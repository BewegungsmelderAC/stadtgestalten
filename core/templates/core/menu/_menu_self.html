{% load static utils %}

{% if user.is_authenticated %}
    <input class="dropdown-state" id="menu-user" type="checkbox" data-menu-group="main">
    <label for="menu-user" class="nav-menu-item nav-state-toggle"
           aria-label="Zeige persönliches Menü" tabindex="0"
           data-component="openable" data-openable-target="#user-menu-dropdown">
        <span class="nav-tab-icon">
            {% include 'gestalten/_avatar.html' with gestalt=user.gestalt link=False size=24 %}
        </span>
        {% include 'gestalten/_avatar.html' with gestalt=user.gestalt link=False size=48 %}
        <span class="nav-menu-item-label">{{ user.gestalt }}</span>
        <i class="caret"></i>
    </label>
{% else %}
    <a href="{% url 'login' %}?next={{ request.path }}" class="nav-menu-item">
        <span class="nav-tab-icon">
            <i class="sg sg-login"></i>
        </span>
        <div class="avatar-wrap">
            <span class="avatar avatar-size-48-48">
                <img src="{% static 'stadt/img/logos/logo_96.png' %}" alt="Stadtgestalten Logo">
            </span>
        </div>
        <span class="nav-menu-item-label">Anmelden</span>
    </a>
{% endif %}

{% if user.is_authenticated %}
    <div class="dock dock-light" id="user-menu-dropdown" data-dropdown data-component="dock">
        <div class="dock-inner">
            <span class="dock-decoration"></span>
            <header class="dock-header">
                {% include 'gestalten/_preview.html' with gestalt=user.gestalt link=False hide_about=True hide_avatar=True %}
                <a href="{% url 'account_logout' %}?next={{ request.path }}"
                   class="dock-session">
                    <i class="sg sg-logout"></i>
                    <span>Abmelden</span>
                </a>
            </header>
            <div class="dock-content">
                <div class="dock-content-inner">
                    <ol class="tabbls">
                        <li data-order="high">
                            <div class="tabbl">
                                <header class="tabbl-header">
                                    <span class="tabbl-title">Profil</span>
                                </header>
                                <div class="tabbl-content">
                                    <div class="tabbl-list">
                                        <a href="{{ user.gestalt.get_profile_url }}">
                                            Deine Seite
                                        </a>
                                        <a href="{% url 'conversations' %}">
                                            Deine Gespräche
                                        </a>
                                        <a href="{% url 'gestalt-update' user.gestalt.pk %}">
                                            Profil ändern
                                        </a>
                                        <a href="{% url 'account_change_password' %}">
                                            Kennwort ändern
                                        </a>
                                        <a href="{% url 'account_email' %}">
                                            E-Mail-Adressen
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </li>
                    </ol>
                </div>
            </div>
        </div>
    </div>
{% endif %}
