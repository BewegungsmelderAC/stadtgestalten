{% load rules %}
{% load rules staticfiles thumbnail %}
{% load content %}

<h2>{% if content.public %}Kommentare{% else %}Antworten{% endif %}</h2>

<ol class="medias">
    {% for comment in content.comments.all %}
        <li>
            <div class="media media-comment">
                <div class="media-image">
                    <a href="{{ comment.author.get_absolute_url }}" class="avatar">
                    {% thumbnail comment.author.avatar '100x100' format='PNG' as avatar %}
                        <img src="{{ avatar.url }}" title="{{ comment.author }}" alt="{{ comment.author }}" class="avatar">
                    {% empty %}
                        <img src="{% static 'avatar.png' %}" title="{{ comment.author }}" alt="{{ comment.author }}" class="avatar">
                    {% endthumbnail %}
                    </a>
                </div>
                <div class="media-content">
                    <div class="media-body" data-component="user-content">
                        {{ comment.text|markdown }}
                    </div>
                    <footer class="media-footer">
                        <time data-component="time time-from" datetime="{{ comment.date_created|date:"c" }}" title="{{ comment.date_created|date:'d. F Y H:i' }}">
                            {{ comment.date_created|date:'d. F Y H:i' }}
                        </time> Â·
                        <a href="{{ comment.author.get_absolute_url }}">{{ comment.author }}</a>
                    </footer>
                </div>
            </div>
        </li>
    {% endfor %}
</ol>

{% has_perm 'content.create_comment' user content as can_create_comment %}
{% if can_create_comment %}
    <a href="{% url 'comment-create' content.pk %}" class="btn btn-default">{% if content.public %}Kommentieren{% else %}Antworten{% endif %}</a>
{% endif %}
