{% extends 'stadt/list.html' %}
{% load rules %}

{% block header %}
    {% include 'entities/_group_header.html' %}
{% endblock %}

{% block heading %}{% endblock %}

{% block list_header %}
    {% has_perm 'entities.create_group_content' user group as can_create_content %}
    {% has_perm 'entities.create_group_message' user group as can_create_message %}

    {% if intro_content %}
        <div class="content-header">
            <h2 class="content-classification decoration-icon sg-pin">Intro</h2>
            {% if can_create_content %}
            <div class="dropdown-container">
                <input type="checkbox" class="dropdown-state" id="intro-content-new" />
                <label class="btn btn-default" for="intro-content-new">
                    Neuer Beitrag <span class="caret"></span>
                </label>
                <ul class="dropdown">
                    <li><a href="{% url 'article-create' %}?group={{ group.slug }}&pinned=1">Artikel</a></li>
                    <li><a href="{% url 'event-create' %}?group={{ group.slug }}&pinned=1">Ereignis</a></li>
                    <li><a href="{% url 'gallery-create' %}?group={{ group.slug }}&pinned=1">Galerie</a></li>
                </ul>
            </div>
            {% endif %}
        </div>

        {% for content in intro_content %}
            {% include 'content/_content_preview.html' %}
        {% endfor %}
    {% endif %}

    {% if internal_messages %}
        <div class="content-header">
            <h2 class="content-classification">Nachrichten</h2>
            {% if can_create_message %}
                <a href="{% url 'message-create' group.pk %}" class="btn btn-default">Neue Nachricht</a>
            {% endif %}
        </div>
        {% for content in internal_messages %}
            {% include 'content/_content_preview.html' %}
        {% endfor %}
        <div class="btn-toolbar btn-toolbar-centered">
            <a href="{% url 'group-messages' group.pk %}" class="btn btn-default">
                Weitere Nachrichten
            </a>
        </div>
    {% endif %}

    <div class="content-header">
        <h2 class="content-classification decoration-icon sg-pen">Beitr√§ge</h2>
        <div class="btn-toolbar">
            {% if can_create_content %}
                <div class="dropdown-container">
                    <input type="checkbox" class="dropdown-state" id="content-new" />
                    <label class="btn btn-default" for="content-new">
                        Neuer Beitrag <span class="caret"></span>
                    </label>
                    <ul class="dropdown">
                        <li><a href="{% url 'article-create' %}?group={{ group.slug }}">Artikel</a></li>
                        <li><a href="{% url 'event-create' %}?group={{ group.slug }}">Ereignis</a></li>
                        <li><a href="{% url 'gallery-create' %}?group={{ group.slug }}">Galerie</a></li>
                        {% if can_create_message %}
                            <li role="separator" class="dropdown-separator"></li>
                            <li><a href="{% url 'message-create' group.pk %}">Interne Nachricht</a></li>
                        {% endif %}
                    </ul>
                </div>
            {% else %}
                <a href="{% url 'message-create' group.pk %}" class="btn btn-default">Neue Nachricht</a>
            {% endif %}
        </div>
    </div>
{% endblock %}

{% block sidebar %}
    {% has_perm 'groups.change_group' user group as can_edit %}
    {% if group.logo or can_edit %}
        {% include 'entities/_sidebar_logo.html' %}
    {% endif %}
    {% include 'calendar/_sidebar.html' %}
    {% include 'entities/_sidebar_groups.html' %}
{% endblock %}
